{"ast":null,"code":"\"use strict\";\n/*\n* indicative-rules\n*\n* (c) Harminder Virk <virk@adonisjs.com>\n*\n* For the full copyright and license information, please view the LICENSE\n* file that was distributed with this source code.\n*/\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst indicative_utils_1 = require(\"indicative-utils\");\n\nconst subset_1 = require(\"../../raw/subset\");\n\nconst isString_1 = require(\"../../raw/isString\");\n\nconst MISSING_VALUE = 'subset:make sure to define subset collection';\n/**\n * Enforces the value of a given field is a subset of expected values. The\n * field value must be an `array` or a `string` of comma seperated values.\n *\n * [casts]\n *   [label fromText=\"comma seperated string\", from=\"string\", to=\"array\"]\n * [/casts]\n *\n * ```ts\n * import { validations } from 'indicative/validator'\n *\n * const rules = {\n *   sort_by: 'subset:email,id,name'\n * }\n *\n * // or\n * const rules = {\n *   sort_by: [\n *     validations.subset(['email', 'id', 'name'])\n *   ]\n * }\n * ```\n */\n\nconst validation = {\n  async: false,\n\n  compile(args) {\n    indicative_utils_1.ensureLength(args, MISSING_VALUE, 1);\n    return args.map(arg => indicative_utils_1.cast(arg, 'string'));\n  },\n\n  validate: (data, field, args, config) => {\n    let fieldValue = indicative_utils_1.getValue(data, field);\n\n    if (indicative_utils_1.skippable(fieldValue, field, config)) {\n      return true;\n    }\n    /**\n     * Convert to array if value is a string\n     */\n\n\n    if (isString_1.isString(fieldValue)) {\n      fieldValue = fieldValue.split(',').map(val => val.trim());\n    } else if (Array.isArray(fieldValue)) {\n      fieldValue = fieldValue.map(value => indicative_utils_1.cast(value, 'string'));\n    } else {\n      return false;\n    }\n\n    if (!subset_1.subset(fieldValue, args)) {\n      return false;\n    }\n    /**\n     * Mutate data field\n     */\n\n\n    indicative_utils_1.patchValue(data, field, fieldValue);\n    return true;\n  }\n};\nexports.default = validation;","map":{"version":3,"sources":["/opt/lampp/htdocs/react-blog/node_modules/indicative-rules/build/src/validations/array-and-string/subset.js"],"names":["Object","defineProperty","exports","value","indicative_utils_1","require","subset_1","isString_1","MISSING_VALUE","validation","async","compile","args","ensureLength","map","arg","cast","validate","data","field","config","fieldValue","getValue","skippable","isString","split","val","trim","Array","isArray","subset","patchValue","default"],"mappings":"AAAA;AACA;;;;;;;;;AAQAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;;AACA,MAAMC,kBAAkB,GAAGC,OAAO,CAAC,kBAAD,CAAlC;;AACA,MAAMC,QAAQ,GAAGD,OAAO,CAAC,kBAAD,CAAxB;;AACA,MAAME,UAAU,GAAGF,OAAO,CAAC,oBAAD,CAA1B;;AACA,MAAMG,aAAa,GAAG,8CAAtB;AACA;;;;;;;;;;;;;;;;;;;;;;;;AAuBA,MAAMC,UAAU,GAAG;AACfC,EAAAA,KAAK,EAAE,KADQ;;AAEfC,EAAAA,OAAO,CAACC,IAAD,EAAO;AACVR,IAAAA,kBAAkB,CAACS,YAAnB,CAAgCD,IAAhC,EAAsCJ,aAAtC,EAAqD,CAArD;AACA,WAAOI,IAAI,CAACE,GAAL,CAAUC,GAAD,IAASX,kBAAkB,CAACY,IAAnB,CAAwBD,GAAxB,EAA6B,QAA7B,CAAlB,CAAP;AACH,GALc;;AAMfE,EAAAA,QAAQ,EAAE,CAACC,IAAD,EAAOC,KAAP,EAAcP,IAAd,EAAoBQ,MAApB,KAA+B;AACrC,QAAIC,UAAU,GAAGjB,kBAAkB,CAACkB,QAAnB,CAA4BJ,IAA5B,EAAkCC,KAAlC,CAAjB;;AACA,QAAIf,kBAAkB,CAACmB,SAAnB,CAA6BF,UAA7B,EAAyCF,KAAzC,EAAgDC,MAAhD,CAAJ,EAA6D;AACzD,aAAO,IAAP;AACH;AACD;;;;;AAGA,QAAIb,UAAU,CAACiB,QAAX,CAAoBH,UAApB,CAAJ,EAAqC;AACjCA,MAAAA,UAAU,GAAGA,UAAU,CAACI,KAAX,CAAiB,GAAjB,EAAsBX,GAAtB,CAA2BY,GAAD,IAASA,GAAG,CAACC,IAAJ,EAAnC,CAAb;AACH,KAFD,MAGK,IAAIC,KAAK,CAACC,OAAN,CAAcR,UAAd,CAAJ,EAA+B;AAChCA,MAAAA,UAAU,GAAGA,UAAU,CAACP,GAAX,CAAgBX,KAAD,IAAWC,kBAAkB,CAACY,IAAnB,CAAwBb,KAAxB,EAA+B,QAA/B,CAA1B,CAAb;AACH,KAFI,MAGA;AACD,aAAO,KAAP;AACH;;AACD,QAAI,CAACG,QAAQ,CAACwB,MAAT,CAAgBT,UAAhB,EAA4BT,IAA5B,CAAL,EAAwC;AACpC,aAAO,KAAP;AACH;AACD;;;;;AAGAR,IAAAA,kBAAkB,CAAC2B,UAAnB,CAA8Bb,IAA9B,EAAoCC,KAApC,EAA2CE,UAA3C;AACA,WAAO,IAAP;AACH;AA/Bc,CAAnB;AAiCAnB,OAAO,CAAC8B,OAAR,GAAkBvB,UAAlB","sourcesContent":["\"use strict\";\n/*\n* indicative-rules\n*\n* (c) Harminder Virk <virk@adonisjs.com>\n*\n* For the full copyright and license information, please view the LICENSE\n* file that was distributed with this source code.\n*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst indicative_utils_1 = require(\"indicative-utils\");\nconst subset_1 = require(\"../../raw/subset\");\nconst isString_1 = require(\"../../raw/isString\");\nconst MISSING_VALUE = 'subset:make sure to define subset collection';\n/**\n * Enforces the value of a given field is a subset of expected values. The\n * field value must be an `array` or a `string` of comma seperated values.\n *\n * [casts]\n *   [label fromText=\"comma seperated string\", from=\"string\", to=\"array\"]\n * [/casts]\n *\n * ```ts\n * import { validations } from 'indicative/validator'\n *\n * const rules = {\n *   sort_by: 'subset:email,id,name'\n * }\n *\n * // or\n * const rules = {\n *   sort_by: [\n *     validations.subset(['email', 'id', 'name'])\n *   ]\n * }\n * ```\n */\nconst validation = {\n    async: false,\n    compile(args) {\n        indicative_utils_1.ensureLength(args, MISSING_VALUE, 1);\n        return args.map((arg) => indicative_utils_1.cast(arg, 'string'));\n    },\n    validate: (data, field, args, config) => {\n        let fieldValue = indicative_utils_1.getValue(data, field);\n        if (indicative_utils_1.skippable(fieldValue, field, config)) {\n            return true;\n        }\n        /**\n         * Convert to array if value is a string\n         */\n        if (isString_1.isString(fieldValue)) {\n            fieldValue = fieldValue.split(',').map((val) => val.trim());\n        }\n        else if (Array.isArray(fieldValue)) {\n            fieldValue = fieldValue.map((value) => indicative_utils_1.cast(value, 'string'));\n        }\n        else {\n            return false;\n        }\n        if (!subset_1.subset(fieldValue, args)) {\n            return false;\n        }\n        /**\n         * Mutate data field\n         */\n        indicative_utils_1.patchValue(data, field, fieldValue);\n        return true;\n    },\n};\nexports.default = validation;\n"]},"metadata":{},"sourceType":"script"}